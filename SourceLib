local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- UI Library Table
local UILib = {}
UILib.__index = UILib

-- Main UI Variables
local UI = Instance.new("ScreenGui")
UI.Name = "MoonUILibrary"
UI.IgnoreGuiInset = true
UI.ResetOnSpawn = false
UI.Parent = player:WaitForChild("PlayerGui")

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 40, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 10)
toggleBtn.Text = "+"
toggleBtn.BackgroundColor3 = Color3.fromRGB(32, 32, 32)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 24
toggleBtn.ZIndex = 2
toggleBtn.Parent = UI

-- Main Frame
local main = Instance.new("Frame")
main.Size = UDim2.new(0, 480, 0, 320)
main.Position = UDim2.new(0.5, -240, 0.5, -160)
main.AnchorPoint = Vector2.new(0.5, 0.5)
main.BackgroundColor3 = Color3.fromRGB(32, 32, 32)
main.Visible = false
main.ClipsDescendants = true
main.Parent = UI

local UICorner = Instance.new("UICorner", main)
UICorner.CornerRadius = UDim.new(0, 10)

-- Tab Holder
local tabHolder = Instance.new("Frame", main)
tabHolder.Size = UDim2.new(0, 100, 1, 0)
tabHolder.BackgroundColor3 = Color3.fromRGB(26, 26, 26)

local tabLayout = Instance.new("UIListLayout", tabHolder)
tabLayout.SortOrder = Enum.SortOrder.LayoutOrder
tabLayout.Padding = UDim.new(0, 4)

-- Content Holder
local content = Instance.new("Frame", main)
content.Position = UDim2.new(0, 100, 0, 0)
content.Size = UDim2.new(1, -100, 1, 0)
content.BackgroundTransparency = 1

-- Open/Close Animation
local isOpen = false
local function toggleUI()
	isOpen = not isOpen
	if isOpen then
		main.Visible = true
		main.Size = UDim2.new(0, 0, 0, 320)
		TweenService:Create(main, TweenInfo.new(0.3), {Size = UDim2.new(0, 480, 0, 320)}):Play()
		toggleBtn.Text = "Ã—"
	else
		TweenService:Create(main, TweenInfo.new(0.3), {Size = UDim2.new(0, 0, 0, 320)}):Play()
		wait(0.3)
		main.Visible = false
		toggleBtn.Text = "+"
	end
end

toggleBtn.MouseButton1Click:Connect(toggleUI)

-- UI Library Functions

function UILib:CreateTab(tabName)
	local tabButton = Instance.new("TextButton")
	tabButton.Size = UDim2.new(1, 0, 0, 30)
	tabButton.Text = tabName
	tabButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	tabButton.Font = Enum.Font.SourceSansBold
	tabButton.TextSize = 18
	tabButton.Parent = tabHolder

	local page = Instance.new("ScrollingFrame")
	page.Size = UDim2.new(1, 0, 1, 0)
	page.CanvasSize = UDim2.new(0, 0, 0, 0)
	page.ScrollBarThickness = 6
	page.Visible = false
	page.BackgroundTransparency = 1
	page.Parent = content

	local layout = Instance.new("UIListLayout", page)
	layout.SortOrder = Enum.SortOrder.LayoutOrder
	layout.Padding = UDim.new(0, 6)

	tabButton.MouseButton1Click:Connect(function()
		for _, v in ipairs(content:GetChildren()) do
			if v:IsA("ScrollingFrame") then
				v.Visible = false
			end
		end
		page.Visible = true
	end)

	return {
		AddButton = function(name, callback)
			local btn = Instance.new("TextButton")
			btn.Size = UDim2.new(1, -10, 0, 30)
			btn.Text = name
			btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
			btn.TextColor3 = Color3.fromRGB(255, 255, 255)
			btn.Font = Enum.Font.SourceSansBold
			btn.TextSize = 18
			btn.Parent = page
			btn.MouseButton1Click:Connect(callback)
		end,

		AddToggle = function(name, callback)
			local toggle = Instance.new("TextButton")
			toggle.Size = UDim2.new(1, -10, 0, 30)
			toggle.Text = name .. ": OFF"
			toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
			toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
			toggle.Font = Enum.Font.SourceSansBold
			toggle.TextSize = 18
			toggle.Parent = page

			local state = false
			toggle.MouseButton1Click:Connect(function()
				state = not state
				toggle.Text = name .. ": " .. (state and "ON" or "OFF")
				callback(state)
			end)
		end,

		AddDropdown = function(name, options, callback)
			local dropdown = Instance.new("TextButton")
			dropdown.Size = UDim2.new(1, -10, 0, 30)
			dropdown.Text = name
			dropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
			dropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
			dropdown.Font = Enum.Font.SourceSansBold
			dropdown.TextSize = 18
			dropdown.Parent = page

			local open = false
			local optFrame = Instance.new("Frame", page)
			optFrame.Size = UDim2.new(1, -10, 0, #options * 30)
			optFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
			optFrame.Visible = false

			local optLayout = Instance.new("UIListLayout", optFrame)
			optLayout.SortOrder = Enum.SortOrder.LayoutOrder

			for _, opt in pairs(options) do
				local btn = Instance.new("TextButton")
				btn.Size = UDim2.new(1, 0, 0, 30)
				btn.Text = opt
				btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
				btn.TextColor3 = Color3.fromRGB(255, 255, 255)
				btn.Font = Enum.Font.SourceSansBold
				btn.TextSize = 18
				btn.Parent = optFrame
				btn.MouseButton1Click:Connect(function()
					callback(opt)
					optFrame.Visible = false
				end)
			end

			dropdown.MouseButton1Click:Connect(function()
				open = not open
				optFrame.Visible = open
			end)
		end,

		CreateLabel = function(text)
			local lbl = Instance.new("TextLabel")
			lbl.Size = UDim2.new(1, -10, 0, 24)
			lbl.Text = text
			lbl.BackgroundTransparency = 1
			lbl.TextColor3 = Color3.fromRGB(255, 255, 255)
			lbl.Font = Enum.Font.SourceSansBold
			lbl.TextSize = 18
			lbl.Parent = page
		end,

		CreateParagraph = function(text)
			local para = Instance.new("TextLabel")
			para.Size = UDim2.new(1, -10, 0, 80)
			para.Text = text
			para.TextWrapped = true
			para.TextYAlignment = Enum.TextYAlignment.Top
			para.BackgroundTransparency = 1
			para.TextColor3 = Color3.fromRGB(200, 200, 200)
			para.Font = Enum.Font.SourceSans
			para.TextSize = 16
			para.Parent = page
		end
	}
end

function UILib:Notify(text)
	local msg = Instance.new("TextLabel", UI)
	msg.Size = UDim2.new(0, 300, 0, 40)
	msg.Position = UDim2.new(0.5, -150, 0, -50)
	msg.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	msg.Text = text
	msg.TextColor3 = Color3.fromRGB(255, 255, 255)
	msg.Font = Enum.Font.SourceSansBold
	msg.TextSize = 18
	msg.Visible = true

	local corner = Instance.new("UICorner", msg)
	corner.CornerRadius = UDim.new(0, 8)

	TweenService:Create(msg, TweenInfo.new(0.5), {Position = UDim2.new(0.5, -150, 0, 10)}):Play()
	wait(2)
	TweenService:Create(msg, TweenInfo.new(0.5), {Position = UDim2.new(0.5, -150, 0, -50)}):Play()
	wait(0.5)
	msg:Destroy()
end

return UILib
