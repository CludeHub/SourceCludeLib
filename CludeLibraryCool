local ExploitUI = {}

local UIS = game:GetService("UserInputService")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer

-- Color Palette
local COLORS = {
	Header = Color3.fromRGB(183, 205, 219),
	Panel = Color3.fromRGB(24, 53, 69),
	TextBox = Color3.fromRGB(192, 225, 240),
	Item = Color3.fromRGB(35, 35, 35),
	Text = Color3.fromRGB(255, 255, 255),
}

-- Command system
local CommandList = {}
local CommandMap = {}

function ExploitUI:CreateWindow(title)
	local screen = Instance.new("ScreenGui", Player:WaitForChild("PlayerGui"))
	screen.Name = "ExploitUI"
	screen.ResetOnSpawn = false

	local holder = Instance.new("Frame", screen)
	holder.AnchorPoint = Vector2.new(0.5, 0.5)
	holder.Position = UDim2.new(0.5, 0, 0.5, 0)
	holder.Size = UDim2.new(0, 400, 0, 350)
	holder.BackgroundColor3 = COLORS.Panel
	holder.BorderSizePixel = 0
	holder.Name = "MainHolder"

	local uicorner = Instance.new("UICorner", holder)
	uicorner.CornerRadius = UDim.new(0, 6)

	local header = Instance.new("Frame", holder)
	header.Size = UDim2.new(1, 0, 0, 40)
	header.BackgroundColor3 = COLORS.Header
	header.BorderSizePixel = 0
	Instance.new("UICorner", header).CornerRadius = UDim.new(0, 6)

	local titleLabel = Instance.new("TextLabel", header)
	titleLabel.Size = UDim2.new(1, 0, 1, 0)
	titleLabel.BackgroundTransparency = 1
	titleLabel.Text = title or "COMMANDS"
	titleLabel.Font = Enum.Font.SourceSansBold
	titleLabel.TextScaled = true
	titleLabel.TextColor3 = COLORS.Text

	local cmdBox = Instance.new("TextBox", holder)
	cmdBox.PlaceholderText = "fly <speed>"
	cmdBox.Text = ""
	cmdBox.Size = UDim2.new(1, -20, 0, 30)
	cmdBox.Position = UDim2.new(0, 10, 0, 50)
	cmdBox.BackgroundColor3 = COLORS.TextBox
	cmdBox.BorderSizePixel = 0
	cmdBox.ClearTextOnFocus = false
	cmdBox.TextColor3 = COLORS.Text
	cmdBox.Font = Enum.Font.SourceSans
	cmdBox.TextSize = 16

	local cmdList = Instance.new("ScrollingFrame", holder)
	cmdList.Position = UDim2.new(0, 10, 0, 90)
	cmdList.Size = UDim2.new(1, -20, 1, -100)
	cmdList.BackgroundColor3 = COLORS.Panel
	cmdList.BorderSizePixel = 0
	cmdList.CanvasSize = UDim2.new(0, 0, 0, 0)
	cmdList.ScrollBarThickness = 4
	cmdList.AutomaticCanvasSize = Enum.AutomaticSize.Y
	cmdList.ClipsDescendants = true

	local listLayout = Instance.new("UIListLayout", cmdList)
	listLayout.Padding = UDim.new(0, 4)

	-- Command activation
	cmdBox.FocusLost:Connect(function(enter)
		if enter then
			local input = cmdBox.Text
			for pattern, callback in pairs(CommandMap) do
				local args = { string.match(input, pattern) }
				if #args > 0 then
					pcall(callback, unpack(args))
					break
				end
			end
		end
	end)

	-- Public API
	function ExploitUI:AddList(cmd)
		local item = Instance.new("TextLabel", cmdList)
		item.Size = UDim2.new(1, -4, 0, 28)
		item.BackgroundColor3 = COLORS.Item
		item.TextColor3 = COLORS.Text
		item.TextXAlignment = Enum.TextXAlignment.Left
		item.Text = "  " .. cmd
		item.Font = Enum.Font.SourceSans
		item.TextSize = 18
		item.BorderSizePixel = 0
		Instance.new("UICorner", item).CornerRadius = UDim.new(0, 4)

		table.insert(CommandList, cmd)
	end

	function ExploitUI:AddCommand(pattern, callback)
		-- Convert 'fly <speed>' into proper Lua pattern
		local luaPattern = pattern:gsub("<%w+>", "([%w%.]+)")
		CommandMap[luaPattern] = callback
		self:AddList(pattern)
	end

	return self
end

return ExploitUI
